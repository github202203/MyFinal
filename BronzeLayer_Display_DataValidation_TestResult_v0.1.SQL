use QAData
--To Check the Test Result
SELECT 'SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords' + 
       '  FROM ' + name + 
       ' Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date)' + ' UNION ' 
  FROM qadata.sys.external_tables
 WHERE name like 'TR_%'

--Display Test Result for Bronze Layer Data Validation ( Bronzr Stage --> Bronze Delta )
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_Addr Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_ApplicationUser Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_LloydsBroker Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_Org Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_OrgName Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_Policy Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_PolicyBroker Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_PolicyLimit Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_PolicyLine Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_PolicyOrg Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_ReportingClass Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) UNION 
SELECT SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) as TestedOn, Count(*) as TotalRecords  FROM TR_Bronze_Role Group By SynapseServerName,Layer,Entity,TestType,SystemName,SystemLoadId,ObjectRunId,TestResultFileName,TestResult,CAST(TestedOn as Date) 